
name: TigerVNC with Serveo
on: [workflow_dispatch]

jobs:
  vnc:
    runs-on: ubuntu-latest
    steps:
    - name: Install VNC and XFCE
      run: |
        sudo apt-get update
        sudo apt-get install -y tigervnc-standalone-server xfce4
        
    - name: Set VNC password
      run: |
        mkdir -p ~/.vnc
        echo "password" | vncpasswd -f > ~/.vnc/passwd
        chmod 600 ~/.vnc/passwd
        
    - name: Start VNC on web port and Serveo tunnel
      run: |
        # Start VNC on port 8080 (web-friendly)
        vncserver -localhost :99 -rfbport 8080
        export DISPLAY=:99
        xfce4-session &
        
        # Serveo can now forward port 80 to port 8080
        echo "ðŸš€ Starting Serveo tunnel..."
        ssh -o StrictHostKeyChecking=no -R 80:localhost:8080 serveo.net
